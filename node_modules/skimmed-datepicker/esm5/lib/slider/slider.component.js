/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import { ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, EventEmitter, Input, NgZone, Output, } from '@angular/core';
import { createEaseOut } from '../util/helpers';
import { slide } from './slide.animation';
import { fromEvent, Subject } from 'rxjs';
import { takeUntil } from 'rxjs/operators';
/**
 * @record
 */
export function AnimationTrigger() { }
function AnimationTrigger_tsickle_Closure_declarations() {
    /** @type {?} */
    AnimationTrigger.prototype.value;
    /** @type {?} */
    AnimationTrigger.prototype.params;
}
var SliderComponent = /** @class */ (function () {
    function SliderComponent(hostRef, cd, zone) {
        this.hostRef = hostRef;
        this.cd = cd;
        this.zone = zone;
        this.prevDisabled = false;
        this.nextDisabled = false;
        this.slideDone = new EventEmitter();
        this.notPanning = true;
        this.wrapperWidth = 1;
        this.panOffset = 0;
        this.ngUnsubscribe$ = new Subject();
        this.easeOut = createEaseOut(1.3);
        this.cd.detach();
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    SliderComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        this.changeSlideTrigger();
    };
    /**
     * @return {?}
     */
    SliderComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.zone.runOutsideAngular(function () {
            var /** @type {?} */ host = _this.hostRef.nativeElement;
            fromEvent(host, 'mousedown').pipe(takeUntil(_this.ngUnsubscribe$)).subscribe(function () { return _this.startPress(); });
            if ('Hammer' in window) {
                var /** @type {?} */ hammer = new Hammer(host);
                fromEvent(hammer, 'panstart').pipe(takeUntil(_this.ngUnsubscribe$)).subscribe(function () { return _this.startPan(); });
                fromEvent(hammer, 'panmove').pipe(takeUntil(_this.ngUnsubscribe$)).subscribe(function (e) { return _this.pan(e); });
                fromEvent(hammer, 'panend pancancel').pipe(takeUntil(_this.ngUnsubscribe$)).subscribe(function () { return _this.endPan(); });
                fromEvent(hammer, 'swiperight').pipe(takeUntil(_this.ngUnsubscribe$)).subscribe(function () { return _this.swipe(-1); });
                fromEvent(hammer, 'swipeleft').pipe(takeUntil(_this.ngUnsubscribe$)).subscribe(function () { return _this.swipe(1); });
            }
        });
    };
    /**
     * @return {?}
     */
    SliderComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.ngUnsubscribe$.next();
        this.ngUnsubscribe$.complete();
    };
    /**
     * @param {?} event
     * @return {?}
     */
    SliderComponent.prototype.done = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (event.toState === this.lastDoneEventToState) {
            // workaround for https://github.com/angular/angular/issues/24084
            return;
        }
        this.lastDoneEventToState = event.toState;
        if (/** @type {?} */ (typeof event.toState) === 'number') {
            this.slideDone.emit(/** @type {?} */ (event.toState));
        }
    };
    /**
     * @param {?} direction
     * @return {?}
     */
    SliderComponent.prototype.slide = /**
     * @param {?} direction
     * @return {?}
     */
    function (direction) {
        var _this = this;
        this.changeSlideTrigger();
        setTimeout(function () { return _this.changeSlideTrigger(/** @type {?} */ (direction)); });
    };
    /**
     * @return {?}
     */
    SliderComponent.prototype.startPress = /**
     * @return {?}
     */
    function () {
        this.notPanning = true;
    };
    /**
     * @return {?}
     */
    SliderComponent.prototype.startPan = /**
     * @return {?}
     */
    function () {
        this.notPanning = false;
        this.wrapperWidth = this.hostRef.nativeElement.offsetWidth;
    };
    /**
     * @param {?} event
     * @return {?}
     */
    SliderComponent.prototype.pan = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var /** @type {?} */ multiplier = (event.deltaX > 0 && this.prevDisabled || event.deltaX < 0 && this.nextDisabled) ? 0.1 : 1;
        var /** @type {?} */ absOffset = Math.abs(event.deltaX / this.wrapperWidth);
        this.panOffset = Math.sign(event.deltaX) * this.easeOut(absOffset);
        this.changeSlideTrigger('panning', this.panOffset * multiplier);
    };
    /**
     * @return {?}
     */
    SliderComponent.prototype.endPan = /**
     * @return {?}
     */
    function () {
        if (Math.abs(this.panOffset) > 0.5) {
            this.changeSlideTrigger(/** @type {?} */ (-Math.sign(this.panOffset)));
        }
        else if (this.slideTrigger.value === 'panning') {
            this.changeSlideTrigger();
        }
    };
    /**
     * @param {?} direction
     * @return {?}
     */
    SliderComponent.prototype.swipe = /**
     * @param {?} direction
     * @return {?}
     */
    function (direction) {
        this.changeSlideTrigger(/** @type {?} */ (direction));
    };
    /**
     * @param {?=} value
     * @param {?=} offset
     * @return {?}
     */
    SliderComponent.prototype.changeSlideTrigger = /**
     * @param {?=} value
     * @param {?=} offset
     * @return {?}
     */
    function (value, offset) {
        if (value === void 0) { value = 'idle'; }
        if (offset === void 0) { offset = 0; }
        this.slideTrigger = {
            value: (value === -1 && this.prevDisabled || value === 1 && this.nextDisabled) ? 'idle' : value,
            params: { x: offset * 100 },
        };
        this.cd.detectChanges();
    };
    SliderComponent.decorators = [
        { type: Component, args: [{
                    selector: 'skm-slider',
                    template: "<div class=\"skm-datepicker-slider\" [@slide]=\"slideTrigger\" (@slide.done)=\"done($event)\">\n  <ng-content></ng-content>\n</div>\n<button type=\"button\" class=\"skm-datepicker-pagination skm-prev\" (click)=\"slide(-1)\" [disabled]=\"prevDisabled\">&lsaquo;</button>\n<button type=\"button\" class=\"skm-datepicker-pagination skm-next\" (click)=\"slide(1)\" [disabled]=\"nextDisabled\">&rsaquo;</button>\n",
                    styles: [":host{display:block;position:relative;height:100%}.skm-datepicker-slider{display:flex;position:relative;left:-100%;height:100%}.skm-datepicker-pagination{position:absolute;top:0}.skm-datepicker-pagination.skm-prev{left:0}.skm-datepicker-pagination.skm-next{right:0}", "button{display:block;color:inherit}button:not([disabled]){cursor:pointer}button[disabled]{pointer-events:none}.skm-datepicker-pane{flex-shrink:0;width:100%;display:flex;flex-direction:column;overflow:hidden}.skm-datepicker-week{display:flex}.skm-datepicker-weekday{width:14.28571%}.skm-datepicker-content{flex:1 0 0;display:flex;flex-direction:column}.skm-datepicker-grid{flex:1 0 0;display:flex;flex-wrap:wrap;align-content:flex-start;pointer-events:none}.skm-datepicker-indent{height:16.66667%}.skm-datepicker-cell{display:flex}:host-context(.skm-datepicker-days-view) .skm-datepicker-cell{width:14.28571%;height:16.66667%}:host-context(.skm-datepicker-months-view) .skm-datepicker-cell{width:33.33333%;height:25%}:host-context(.skm-datepicker-years-view) .skm-datepicker-cell{width:20%;height:25%}.skm-datepicker-item{flex:1;pointer-events:auto}"],
                    animations: [slide()],
                    changeDetection: ChangeDetectionStrategy.OnPush,
                },] },
    ];
    /** @nocollapse */
    SliderComponent.ctorParameters = function () { return [
        { type: ElementRef, },
        { type: ChangeDetectorRef, },
        { type: NgZone, },
    ]; };
    SliderComponent.propDecorators = {
        "prevDisabled": [{ type: Input },],
        "nextDisabled": [{ type: Input },],
        "slideDone": [{ type: Output },],
    };
    return SliderComponent;
}());
export { SliderComponent };
function SliderComponent_tsickle_Closure_declarations() {
    /** @type {!Array<{type: !Function, args: (undefined|!Array<?>)}>} */
    SliderComponent.decorators;
    /**
     * @nocollapse
     * @type {function(): !Array<(null|{type: ?, decorators: (undefined|!Array<{type: !Function, args: (undefined|!Array<?>)}>)})>}
     */
    SliderComponent.ctorParameters;
    /** @type {!Object<string,!Array<{type: !Function, args: (undefined|!Array<?>)}>>} */
    SliderComponent.propDecorators;
    /** @type {?} */
    SliderComponent.prototype.prevDisabled;
    /** @type {?} */
    SliderComponent.prototype.nextDisabled;
    /** @type {?} */
    SliderComponent.prototype.slideDone;
    /** @type {?} */
    SliderComponent.prototype.notPanning;
    /** @type {?} */
    SliderComponent.prototype.slideTrigger;
    /** @type {?} */
    SliderComponent.prototype.wrapperWidth;
    /** @type {?} */
    SliderComponent.prototype.panOffset;
    /** @type {?} */
    SliderComponent.prototype.lastDoneEventToState;
    /** @type {?} */
    SliderComponent.prototype.ngUnsubscribe$;
    /** @type {?} */
    SliderComponent.prototype.easeOut;
    /** @type {?} */
    SliderComponent.prototype.hostRef;
    /** @type {?} */
    SliderComponent.prototype.cd;
    /** @type {?} */
    SliderComponent.prototype.zone;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2xpZGVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL3NraW1tZWQtZGF0ZXBpY2tlci8iLCJzb3VyY2VzIjpbImxpYi9zbGlkZXIvc2xpZGVyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUVMLHVCQUF1QixFQUN2QixpQkFBaUIsRUFDakIsU0FBUyxFQUNULFVBQVUsRUFDVixZQUFZLEVBQ1osS0FBSyxFQUNMLE1BQU0sRUFHTixNQUFNLEdBRVAsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBRWhELE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUMxQyxPQUFPLEVBQUUsU0FBUyxFQUFFLE9BQU8sRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUMxQyxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7Ozs7Ozs7Ozs7OztJQXVDekMseUJBQW9CLE9BQW1CLEVBQVUsRUFBcUIsRUFBVSxJQUFZO1FBQXhFLFlBQU8sR0FBUCxPQUFPLENBQVk7UUFBVSxPQUFFLEdBQUYsRUFBRSxDQUFtQjtRQUFVLFNBQUksR0FBSixJQUFJLENBQVE7NEJBZnBFLEtBQUs7NEJBQ0wsS0FBSzt5QkFFUCxJQUFJLFlBQVksRUFBVTswQkFDbkMsSUFBSTs0QkFJTSxDQUFDO3lCQUNKLENBQUM7OEJBR2EsSUFBSSxPQUFPLEVBQUU7dUJBQ3BCLGFBQWEsQ0FBQyxHQUFHLENBQUM7UUFHM0MsSUFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsQ0FBQztLQUNsQjs7Ozs7SUFFRCxxQ0FBVzs7OztJQUFYLFVBQVksT0FBc0I7UUFDaEMsSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUM7S0FDM0I7Ozs7SUFFRCx5Q0FBZTs7O0lBQWY7UUFBQSxpQkFnQkM7UUFmQyxJQUFJLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDO1lBQzFC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O2NBQUMsU0FBaUI7UUFDN0IsSUFBSSxDQUFDLGtCQUFrQixtQkFBQyxTQUFtQixFQUFDLENBQUM7Ozs7Ozs7SUFHdkMsNENBQWtCOzs7OztjQUFDLEtBQTJDLEVBQUUsTUFBVTtRQUF2RCxzQkFBQSxFQUFBLGNBQTJDO1FBQUUsdUJBQUEsRUFBQSxVQUFVO1FBQ2hGLElBQUksQ0FBQyxZQUFZLEdBQUc7WUFDbEIsS0FBSyxFQUFFLENBQUMsS0FBSyxLQUFLLENBQUMsQ0FBQyxJQUFJLElBQUksQ0FBQyxZQUFZLElBQUksS0FBSyxLQUFLLENBQUMsSUFBSSxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsS0FBSztZQUMvRixNQUFNLEVBQUUsRUFBQyxDQUFDLEVBQUUsTUFBTSxHQUFHLEdBQUcsRUFBQztTQUMxQixDQUFDO1FBQ0YsSUFBSSxDQUFDLEVBQUUsQ0FBQyxhQUFhLEVBQUUsQ0FBQzs7O2dCQTVHM0IsU0FBUyxTQUFDO29CQUNULFFBQVEsRUFBRSxZQUFZO29CQUN0QixRQUFRLEVBQUUsMFpBS1g7b0JBQ0MsTUFBTSxFQUFFLENBQUMsMlFBQTJRLEVBQUUsazFCQUFrMUIsQ0FBQztvQkFDem1DLFVBQVUsRUFBRSxDQUFDLEtBQUssRUFBRSxDQUFDO29CQUNyQixlQUFlLEVBQUUsdUJBQXVCLENBQUMsTUFBTTtpQkFDaEQ7Ozs7Z0JBbkNDLFVBQVU7Z0JBRlYsaUJBQWlCO2dCQUtqQixNQUFNOzs7aUNBa0NMLEtBQUs7aUNBQ0wsS0FBSzs4QkFFTCxNQUFNOzswQkE3Q1Q7O1NBeUNhLGVBQWUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gIEFmdGVyVmlld0luaXQsXHJcbiAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXHJcbiAgQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgQ29tcG9uZW50LFxyXG4gIEVsZW1lbnRSZWYsXHJcbiAgRXZlbnRFbWl0dGVyLFxyXG4gIElucHV0LFxyXG4gIE5nWm9uZSxcclxuICBPbkNoYW5nZXMsXHJcbiAgT25EZXN0cm95LFxyXG4gIE91dHB1dCxcclxuICBTaW1wbGVDaGFuZ2VzLFxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBjcmVhdGVFYXNlT3V0IH0gZnJvbSAnLi4vdXRpbC9oZWxwZXJzJztcclxuaW1wb3J0IHsgQW5pbWF0aW9uRXZlbnQgfSBmcm9tICdAYW5ndWxhci9hbmltYXRpb25zJztcclxuaW1wb3J0IHsgc2xpZGUgfSBmcm9tICcuL3NsaWRlLmFuaW1hdGlvbic7XHJcbmltcG9ydCB7IGZyb21FdmVudCwgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyB0YWtlVW50aWwgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcblxyXG5kZWNsYXJlIGNsYXNzIEhhbW1lciBleHRlbmRzIEV2ZW50VGFyZ2V0IHtcclxuICBjb25zdHJ1Y3Rvcih0YXJnZXQ6IEV2ZW50VGFyZ2V0KTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBbmltYXRpb25UcmlnZ2VyIHtcclxuICB2YWx1ZTogc3RyaW5nIHwgbnVtYmVyO1xyXG4gIHBhcmFtczogeyBbcDogc3RyaW5nXTogYW55IH07XHJcbn1cclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnc2ttLXNsaWRlcicsXHJcbiAgdGVtcGxhdGU6IGA8ZGl2IGNsYXNzPVwic2ttLWRhdGVwaWNrZXItc2xpZGVyXCIgW0BzbGlkZV09XCJzbGlkZVRyaWdnZXJcIiAoQHNsaWRlLmRvbmUpPVwiZG9uZSgkZXZlbnQpXCI+XHJcbiAgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PlxyXG48L2Rpdj5cclxuPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJza20tZGF0ZXBpY2tlci1wYWdpbmF0aW9uIHNrbS1wcmV2XCIgKGNsaWNrKT1cInNsaWRlKC0xKVwiIFtkaXNhYmxlZF09XCJwcmV2RGlzYWJsZWRcIj4mbHNhcXVvOzwvYnV0dG9uPlxyXG48YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cInNrbS1kYXRlcGlja2VyLXBhZ2luYXRpb24gc2ttLW5leHRcIiAoY2xpY2spPVwic2xpZGUoMSlcIiBbZGlzYWJsZWRdPVwibmV4dERpc2FibGVkXCI+JnJzYXF1bzs8L2J1dHRvbj5cclxuYCxcclxuICBzdHlsZXM6IFtgOmhvc3R7ZGlzcGxheTpibG9jaztwb3NpdGlvbjpyZWxhdGl2ZTtoZWlnaHQ6MTAwJX0uc2ttLWRhdGVwaWNrZXItc2xpZGVye2Rpc3BsYXk6ZmxleDtwb3NpdGlvbjpyZWxhdGl2ZTtsZWZ0Oi0xMDAlO2hlaWdodDoxMDAlfS5za20tZGF0ZXBpY2tlci1wYWdpbmF0aW9ue3Bvc2l0aW9uOmFic29sdXRlO3RvcDowfS5za20tZGF0ZXBpY2tlci1wYWdpbmF0aW9uLnNrbS1wcmV2e2xlZnQ6MH0uc2ttLWRhdGVwaWNrZXItcGFnaW5hdGlvbi5za20tbmV4dHtyaWdodDowfWAsIGBidXR0b257ZGlzcGxheTpibG9jaztjb2xvcjppbmhlcml0fWJ1dHRvbjpub3QoW2Rpc2FibGVkXSl7Y3Vyc29yOnBvaW50ZXJ9YnV0dG9uW2Rpc2FibGVkXXtwb2ludGVyLWV2ZW50czpub25lfS5za20tZGF0ZXBpY2tlci1wYW5le2ZsZXgtc2hyaW5rOjA7d2lkdGg6MTAwJTtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO292ZXJmbG93OmhpZGRlbn0uc2ttLWRhdGVwaWNrZXItd2Vla3tkaXNwbGF5OmZsZXh9LnNrbS1kYXRlcGlja2VyLXdlZWtkYXl7d2lkdGg6MTQuMjg1NzElfS5za20tZGF0ZXBpY2tlci1jb250ZW50e2ZsZXg6MSAwIDA7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbn0uc2ttLWRhdGVwaWNrZXItZ3JpZHtmbGV4OjEgMCAwO2Rpc3BsYXk6ZmxleDtmbGV4LXdyYXA6d3JhcDthbGlnbi1jb250ZW50OmZsZXgtc3RhcnQ7cG9pbnRlci1ldmVudHM6bm9uZX0uc2ttLWRhdGVwaWNrZXItaW5kZW50e2hlaWdodDoxNi42NjY2NyV9LnNrbS1kYXRlcGlja2VyLWNlbGx7ZGlzcGxheTpmbGV4fTpob3N0LWNvbnRleHQoLnNrbS1kYXRlcGlja2VyLWRheXMtdmlldykgLnNrbS1kYXRlcGlja2VyLWNlbGx7d2lkdGg6MTQuMjg1NzElO2hlaWdodDoxNi42NjY2NyV9Omhvc3QtY29udGV4dCguc2ttLWRhdGVwaWNrZXItbW9udGhzLXZpZXcpIC5za20tZGF0ZXBpY2tlci1jZWxse3dpZHRoOjMzLjMzMzMzJTtoZWlnaHQ6MjUlfTpob3N0LWNvbnRleHQoLnNrbS1kYXRlcGlja2VyLXllYXJzLXZpZXcpIC5za20tZGF0ZXBpY2tlci1jZWxse3dpZHRoOjIwJTtoZWlnaHQ6MjUlfS5za20tZGF0ZXBpY2tlci1pdGVte2ZsZXg6MTtwb2ludGVyLWV2ZW50czphdXRvfWBdLFxyXG4gIGFuaW1hdGlvbnM6IFtzbGlkZSgpXSxcclxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcclxufSlcclxuZXhwb3J0IGNsYXNzIFNsaWRlckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uQ2hhbmdlcywgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95IHtcclxuICBASW5wdXQoKSBwcmV2RGlzYWJsZWQgPSBmYWxzZTtcclxuICBASW5wdXQoKSBuZXh0RGlzYWJsZWQgPSBmYWxzZTtcclxuXHJcbiAgQE91dHB1dCgpIHNsaWRlRG9uZSA9IG5ldyBFdmVudEVtaXR0ZXI8bnVtYmVyPigpO1xyXG4gIG5vdFBhbm5pbmcgPSB0cnVlO1xyXG5cclxuICBzbGlkZVRyaWdnZXI6IEFuaW1hdGlvblRyaWdnZXI7XHJcblxyXG4gIHByaXZhdGUgd3JhcHBlcldpZHRoID0gMTtcclxuICBwcml2YXRlIHBhbk9mZnNldCA9IDA7XHJcbiAgcHJpdmF0ZSBsYXN0RG9uZUV2ZW50VG9TdGF0ZTogc3RyaW5nIHwgbnVtYmVyO1xyXG5cclxuICBwcml2YXRlIHJlYWRvbmx5IG5nVW5zdWJzY3JpYmUkID0gbmV3IFN1YmplY3QoKTtcclxuICBwcml2YXRlIHJlYWRvbmx5IGVhc2VPdXQgPSBjcmVhdGVFYXNlT3V0KDEuMyk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgaG9zdFJlZjogRWxlbWVudFJlZiwgcHJpdmF0ZSBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYsIHByaXZhdGUgem9uZTogTmdab25lKSB7XHJcbiAgICB0aGlzLmNkLmRldGFjaCgpO1xyXG4gIH1cclxuXHJcbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xyXG4gICAgdGhpcy5jaGFuZ2VTbGlkZVRyaWdnZXIoKTtcclxuICB9XHJcblxyXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcclxuICAgIHRoaXMuem9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGhvc3QgPSB0aGlzLmhvc3RSZWYubmF0aXZlRWxlbWVudDtcclxuICAgICAgZnJvbUV2ZW50KGhvc3QsICdtb3VzZWRvd24nKS5waXBlKHRha2VVbnRpbCh0aGlzLm5nVW5zdWJzY3JpYmUkKSkuc3Vic2NyaWJlKCgpID0+IHRoaXMuc3RhcnRQcmVzcygpKTtcclxuXHJcbiAgICAgIGlmICgnSGFtbWVyJyBpbiB3aW5kb3cpIHtcclxuICAgICAgICBjb25zdCBoYW1tZXIgPSBuZXcgSGFtbWVyKGhvc3QpO1xyXG5cclxuICAgICAgICBmcm9tRXZlbnQoaGFtbWVyLCAncGFuc3RhcnQnKS5waXBlKHRha2VVbnRpbCh0aGlzLm5nVW5zdWJzY3JpYmUkKSkuc3Vic2NyaWJlKCgpID0+IHRoaXMuc3RhcnRQYW4oKSk7XHJcbiAgICAgICAgZnJvbUV2ZW50KGhhbW1lciwgJ3Bhbm1vdmUnKS5waXBlKHRha2VVbnRpbCh0aGlzLm5nVW5zdWJzY3JpYmUkKSkuc3Vic2NyaWJlKGUgPT4gdGhpcy5wYW4oZSkpO1xyXG4gICAgICAgIGZyb21FdmVudChoYW1tZXIsICdwYW5lbmQgcGFuY2FuY2VsJykucGlwZSh0YWtlVW50aWwodGhpcy5uZ1Vuc3Vic2NyaWJlJCkpLnN1YnNjcmliZSgoKSA9PiB0aGlzLmVuZFBhbigpKTtcclxuXHJcbiAgICAgICAgZnJvbUV2ZW50KGhhbW1lciwgJ3N3aXBlcmlnaHQnKS5waXBlKHRha2VVbnRpbCh0aGlzLm5nVW5zdWJzY3JpYmUkKSkuc3Vic2NyaWJlKCgpID0+IHRoaXMuc3dpcGUoLTEpKTtcclxuICAgICAgICBmcm9tRXZlbnQoaGFtbWVyLCAnc3dpcGVsZWZ0JykucGlwZSh0YWtlVW50aWwodGhpcy5uZ1Vuc3Vic2NyaWJlJCkpLnN1YnNjcmliZSgoKSA9PiB0aGlzLnN3aXBlKDEpKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgIHRoaXMubmdVbnN1YnNjcmliZSQubmV4dCgpO1xyXG4gICAgdGhpcy5uZ1Vuc3Vic2NyaWJlJC5jb21wbGV0ZSgpO1xyXG4gIH1cclxuXHJcbiAgZG9uZShldmVudDogQW5pbWF0aW9uRXZlbnQpOiB2b2lkIHtcclxuICAgIGlmIChldmVudC50b1N0YXRlID09PSB0aGlzLmxhc3REb25lRXZlbnRUb1N0YXRlKSB7XHJcbiAgICAgIC8vIHdvcmthcm91bmQgZm9yIGh0dHBzOi8vZ2l0aHViLmNvbS9hbmd1bGFyL2FuZ3VsYXIvaXNzdWVzLzI0MDg0XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMubGFzdERvbmVFdmVudFRvU3RhdGUgPSBldmVudC50b1N0YXRlO1xyXG4gICAgaWYgKHR5cGVvZiBldmVudC50b1N0YXRlIGFzIHN0cmluZyB8IG51bWJlciA9PT0gJ251bWJlcicpIHtcclxuICAgICAgdGhpcy5zbGlkZURvbmUuZW1pdChldmVudC50b1N0YXRlIGFzIGFueSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzbGlkZShkaXJlY3Rpb246IG51bWJlcik6IHZvaWQge1xyXG4gICAgdGhpcy5jaGFuZ2VTbGlkZVRyaWdnZXIoKTtcclxuICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5jaGFuZ2VTbGlkZVRyaWdnZXIoZGlyZWN0aW9uIGFzIC0xIHwgMSkpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzdGFydFByZXNzKCk6IHZvaWQge1xyXG4gICAgdGhpcy5ub3RQYW5uaW5nID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc3RhcnRQYW4oKTogdm9pZCB7XHJcbiAgICB0aGlzLm5vdFBhbm5pbmcgPSBmYWxzZTtcclxuICAgIHRoaXMud3JhcHBlcldpZHRoID0gdGhpcy5ob3N0UmVmLm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGg7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHBhbihldmVudDogYW55KTogdm9pZCB7XHJcbiAgICBjb25zdCBtdWx0aXBsaWVyID0gKGV2ZW50LmRlbHRhWCA+IDAgJiYgdGhpcy5wcmV2RGlzYWJsZWQgfHwgZXZlbnQuZGVsdGFYIDwgMCAmJiB0aGlzLm5leHREaXNhYmxlZCkgPyAwLjEgOiAxO1xyXG4gICAgY29uc3QgYWJzT2Zmc2V0ID0gTWF0aC5hYnMoZXZlbnQuZGVsdGFYIC8gdGhpcy53cmFwcGVyV2lkdGgpO1xyXG4gICAgdGhpcy5wYW5PZmZzZXQgPSBNYXRoLnNpZ24oZXZlbnQuZGVsdGFYKSAqIHRoaXMuZWFzZU91dChhYnNPZmZzZXQpO1xyXG4gICAgdGhpcy5jaGFuZ2VTbGlkZVRyaWdnZXIoJ3Bhbm5pbmcnLCB0aGlzLnBhbk9mZnNldCAqIG11bHRpcGxpZXIpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBlbmRQYW4oKTogdm9pZCB7XHJcbiAgICBpZiAoTWF0aC5hYnModGhpcy5wYW5PZmZzZXQpID4gMC41KSB7XHJcbiAgICAgIHRoaXMuY2hhbmdlU2xpZGVUcmlnZ2VyKC1NYXRoLnNpZ24odGhpcy5wYW5PZmZzZXQpIGFzIC0xIHwgMSk7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMuc2xpZGVUcmlnZ2VyLnZhbHVlID09PSAncGFubmluZycpIHtcclxuICAgICAgdGhpcy5jaGFuZ2VTbGlkZVRyaWdnZXIoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgc3dpcGUoZGlyZWN0aW9uOiBudW1iZXIpOiB2b2lkIHtcclxuICAgIHRoaXMuY2hhbmdlU2xpZGVUcmlnZ2VyKGRpcmVjdGlvbiBhcyAtMSB8IDEpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjaGFuZ2VTbGlkZVRyaWdnZXIodmFsdWU6ICdwYW5uaW5nJyB8ICdpZGxlJyB8IC0xIHwgMSA9ICdpZGxlJywgb2Zmc2V0ID0gMCk6IHZvaWQge1xyXG4gICAgdGhpcy5zbGlkZVRyaWdnZXIgPSB7XHJcbiAgICAgIHZhbHVlOiAodmFsdWUgPT09IC0xICYmIHRoaXMucHJldkRpc2FibGVkIHx8IHZhbHVlID09PSAxICYmIHRoaXMubmV4dERpc2FibGVkKSA/ICdpZGxlJyA6IHZhbHVlLFxyXG4gICAgICBwYXJhbXM6IHt4OiBvZmZzZXQgKiAxMDB9LFxyXG4gICAgfTtcclxuICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gIH1cclxuXHJcbn1cclxuIl19