/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import { ChangeDetectionStrategy, ChangeDetectorRef, Component, EventEmitter, Inject, Input, LOCALE_ID, Output, } from '@angular/core';
import { FormStyle, getLocaleDayNames, TranslationWidth, WeekDay } from '@angular/common';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { isValidDate, noop, startOfDay } from '../util/helpers';
import { ViewMode } from './view-mode';
export class DatepickerComponent {
    /**
     * @param {?} cd
     * @param {?} locale
     */
    constructor(cd, locale) {
        this.cd = cd;
        this.locale = locale;
        this.dateChange = new EventEmitter();
        this.dayFormat = 'd';
        this.monthFormat = 'MMM';
        this.yearFormat = 'y';
        this.headingFormat = 'MMMM y';
        this.weekStart = WeekDay.Monday;
        this.view = ViewMode.Days;
        this.ViewMode = ViewMode;
        this.onChange = noop;
        this.onTouched = noop;
    }
    /**
     * @param {?} dirtyDate
     * @return {?}
     */
    set date(dirtyDate) {
        if (dirtyDate == null) {
            this.selectedTimestamp = undefined;
            return;
        }
        const /** @type {?} */ date = startOfDay(dirtyDate);
        if (date.getTime() !== this.selectedTimestamp) {
            this.selectedTimestamp = isValidDate(date) ? date.getTime() : undefined;
            if (typeof this.selectedTimestamp !== 'undefined') {
                this.initialTimestamp = this.selectedTimestamp;
                this.view = ViewMode.Days;
            }
        }
    }
    /**
     * @param {?} dirtyDate
     * @return {?}
     */
    set min(dirtyDate) {
        const /** @type {?} */ date = startOfDay(dirtyDate);
        this.minTimestamp = isValidDate(date) ? date.valueOf() : undefined;
    }
    /**
     * @param {?} dirtyDate
     * @return {?}
     */
    set max(dirtyDate) {
        const /** @type {?} */ date = startOfDay(dirtyDate);
        this.maxTimestamp = isValidDate(date) ? date.valueOf() : undefined;
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if ('weekDayLabels' in changes) {
            this.weekDayLabels = this.weekDayLabels || getLocaleDayNames(this.locale, FormStyle.Standalone, TranslationWidth.Abbreviated);
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.currentTimestamp = startOfDay(new Date()).getTime();
        this.initialTimestamp = this.selectedTimestamp || this.currentTimestamp;
        this.weekDayLabels = this.weekDayLabels || getLocaleDayNames(this.locale, FormStyle.Standalone, TranslationWidth.Abbreviated);
    }
    /**
     * @param {?} timestamp
     * @return {?}
     */
    selectDay(timestamp) {
        console.log(timestamp);
        this.selectedTimestamp = timestamp;
        const /** @type {?} */ date = (typeof timestamp !== 'undefined') ? new Date(timestamp) : undefined;
        this.onChange(date);
        this.dateChange.emit(date);
    }
    /**
     * @param {?} timestamp
     * @param {?} view
     * @param {?} direction
     * @return {?}
     */
    switchView(timestamp, view, direction) {
        this.zoomDirection = direction;
        setTimeout(() => {
            this.initialTimestamp = timestamp;
            this.view = view;
            this.cd.markForCheck();
        });
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    writeValue(obj) {
        this.date = obj;
        this.cd.markForCheck();
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnChange(fn) {
        this.onChange = fn;
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnTouched(fn) {
        this.onTouched = fn;
        // TODO implement
    }
    /**
     * @param {?} isDisabled
     * @return {?}
     */
    setDisabledState(isDisabled) {
        // TODO implement
        this.cd.markForCheck();
    }
}
DatepickerComponent.decorators = [
    { type: Component, args: [{
                selector: 'skm-datepicker',
                template: `<div class="skm-datepicker" [ngSwitch]="view">
  <skm-view
    *ngSwitchCase="ViewMode.Days"
    skmDaysStrategy
    class="skm-datepicker-view skm-datepicker-days-view"
    [zoomDirection]="zoomDirection"
    [initialTimestamp]="initialTimestamp"

    [currentTimestamp]="currentTimestamp"
    [selectedTimestamp]="selectedTimestamp"
    [minTimestamp]="minTimestamp"
    [maxTimestamp]="maxTimestamp"

    [deselectEnabled]="deselectEnabled"

    [headingFormat]="headingFormat"
    [weekStart]="weekStart"
    [weekDayLabels]="weekDayLabels"
    [itemFormat]="dayFormat"
    [itemLabels]="dayLabels"

    (headerClick)="switchView($event, ViewMode.Months, 'out')"
    (itemChange)="selectDay($event)"
  ></skm-view>
  <skm-view
    *ngSwitchCase="ViewMode.Months"
    skmMonthsStrategy
    class="skm-datepicker-view skm-datepicker-months-view"
    [zoomDirection]="zoomDirection"
    [initialTimestamp]="initialTimestamp"

    [currentTimestamp]="currentTimestamp"
    [selectedTimestamp]="selectedTimestamp"
    [minTimestamp]="minTimestamp"
    [maxTimestamp]="maxTimestamp"

    [headingFormat]="yearFormat"
    [itemFormat]="monthFormat"
    [itemLabels]="monthLabels"

    (headerClick)="switchView($event, ViewMode.Years, 'out')"
    (itemChange)="switchView($event, ViewMode.Days, 'in')"
  ></skm-view>
  <skm-view
    *ngSwitchCase="ViewMode.Years"
    skmYearsStrategy
    class="skm-datepicker-view skm-datepicker-years-view"
    [zoomDirection]="zoomDirection"
    [initialTimestamp]="initialTimestamp"

    [currentTimestamp]="currentTimestamp"
    [selectedTimestamp]="selectedTimestamp"
    [minTimestamp]="minTimestamp"
    [maxTimestamp]="maxTimestamp"

    [headingFormat]="yearFormat"
    [itemFormat]="yearFormat"

    (itemChange)="switchView($event, ViewMode.Months, 'in')"
  ></skm-view>
</div>
`,
                styles: [`.skm-datepicker{position:relative;overflow:hidden}.skm-datepicker-view{display:block;position:absolute;height:100%;width:100%}`, `button{display:block;color:inherit}button:not([disabled]){cursor:pointer}button[disabled]{pointer-events:none}.skm-datepicker-pane{flex-shrink:0;width:100%;display:flex;flex-direction:column;overflow:hidden}.skm-datepicker-week{display:flex}.skm-datepicker-weekday{width:14.28571%}.skm-datepicker-content{flex:1 0 0;display:flex;flex-direction:column}.skm-datepicker-grid{flex:1 0 0;display:flex;flex-wrap:wrap;align-content:flex-start;pointer-events:none}.skm-datepicker-indent{height:16.66667%}.skm-datepicker-cell{display:flex}:host-context(.skm-datepicker-days-view) .skm-datepicker-cell{width:14.28571%;height:16.66667%}:host-context(.skm-datepicker-months-view) .skm-datepicker-cell{width:33.33333%;height:25%}:host-context(.skm-datepicker-years-view) .skm-datepicker-cell{width:20%;height:25%}.skm-datepicker-item{flex:1;pointer-events:auto}`],
                changeDetection: ChangeDetectionStrategy.OnPush,
                providers: [
                    { provide: NG_VALUE_ACCESSOR, useExisting: DatepickerComponent, multi: true },
                ],
            },] },
];
/** @nocollapse */
DatepickerComponent.ctorParameters = () => [
    { type: ChangeDetectorRef, },
    { type: undefined, decorators: [{ type: Inject, args: [LOCALE_ID,] },] },
];
DatepickerComponent.propDecorators = {
    "date": [{ type: Input },],
    "dateChange": [{ type: Output },],
    "min": [{ type: Input },],
    "max": [{ type: Input },],
    "deselectEnabled": [{ type: Input },],
    "dayFormat": [{ type: Input },],
    "monthFormat": [{ type: Input },],
    "yearFormat": [{ type: Input },],
    "headingFormat": [{ type: Input },],
    "weekStart": [{ type: Input },],
    "dayLabels": [{ type: Input },],
    "weekDayLabels": [{ type: Input },],
    "monthLabels": [{ type: Input },],
    "view": [{ type: Input },],
};
function DatepickerComponent_tsickle_Closure_declarations() {
    /** @type {!Array<{type: !Function, args: (undefined|!Array<?>)}>} */
    DatepickerComponent.decorators;
    /**
     * @nocollapse
     * @type {function(): !Array<(null|{type: ?, decorators: (undefined|!Array<{type: !Function, args: (undefined|!Array<?>)}>)})>}
     */
    DatepickerComponent.ctorParameters;
    /** @type {!Object<string,!Array<{type: !Function, args: (undefined|!Array<?>)}>>} */
    DatepickerComponent.propDecorators;
    /** @type {?} */
    DatepickerComponent.prototype.dateChange;
    /** @type {?} */
    DatepickerComponent.prototype.deselectEnabled;
    /** @type {?} */
    DatepickerComponent.prototype.dayFormat;
    /** @type {?} */
    DatepickerComponent.prototype.monthFormat;
    /** @type {?} */
    DatepickerComponent.prototype.yearFormat;
    /** @type {?} */
    DatepickerComponent.prototype.headingFormat;
    /** @type {?} */
    DatepickerComponent.prototype.weekStart;
    /** @type {?} */
    DatepickerComponent.prototype.dayLabels;
    /** @type {?} */
    DatepickerComponent.prototype.weekDayLabels;
    /** @type {?} */
    DatepickerComponent.prototype.monthLabels;
    /** @type {?} */
    DatepickerComponent.prototype.view;
    /** @type {?} */
    DatepickerComponent.prototype.initialTimestamp;
    /** @type {?} */
    DatepickerComponent.prototype.currentTimestamp;
    /** @type {?} */
    DatepickerComponent.prototype.selectedTimestamp;
    /** @type {?} */
    DatepickerComponent.prototype.minTimestamp;
    /** @type {?} */
    DatepickerComponent.prototype.maxTimestamp;
    /** @type {?} */
    DatepickerComponent.prototype.zoomDirection;
    /** @type {?} */
    DatepickerComponent.prototype.ViewMode;
    /** @type {?} */
    DatepickerComponent.prototype.onChange;
    /** @type {?} */
    DatepickerComponent.prototype.onTouched;
    /** @type {?} */
    DatepickerComponent.prototype.cd;
    /** @type {?} */
    DatepickerComponent.prototype.locale;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0ZXBpY2tlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9za2ltbWVkLWRhdGVwaWNrZXIvIiwic291cmNlcyI6WyJsaWIvZGF0ZXBpY2tlci9kYXRlcGlja2VyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUNMLHVCQUF1QixFQUN2QixpQkFBaUIsRUFDakIsU0FBUyxFQUNULFlBQVksRUFDWixNQUFNLEVBQ04sS0FBSyxFQUNMLFNBQVMsRUFHVCxNQUFNLEdBRVAsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLFNBQVMsRUFBRSxpQkFBaUIsRUFBRSxnQkFBZ0IsRUFBRSxPQUFPLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUMxRixPQUFPLEVBQXdCLGlCQUFpQixFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDekUsT0FBTyxFQUFFLFdBQVcsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDaEUsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLGFBQWEsQ0FBQztBQXlFdkMsTUFBTTs7Ozs7SUFzREosWUFBb0IsRUFBcUIsRUFBNkI7UUFBbEQsT0FBRSxHQUFGLEVBQUUsQ0FBbUI7UUFBNkIsV0FBTSxHQUFOLE1BQU07MEJBdENyRCxJQUFJLFlBQVksRUFBUTt5QkFjMUIsR0FBRzsyQkFDRCxLQUFLOzBCQUNOLEdBQUc7NkJBQ0EsUUFBUTt5QkFDWixPQUFPLENBQUMsTUFBTTtvQkFNbkIsUUFBUSxDQUFDLElBQUk7d0JBU1QsUUFBUTt3QkFFYSxJQUFJO3lCQUNiLElBQUk7S0FHbkM7Ozs7O1FBdERZLElBQUksQ0FBQyxTQUF3QjtRQUN4QyxFQUFFLENBQUMsQ0FBQyxTQUFTLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQztZQUN0QixJQUFJLENBQUMsaUJBQWlCLEdBQUcsU0FBUyxDQUFDO1lBQ25DLE1BQU0sQ0FBQztTQUNSO1FBQ0QsdUJBQU0sSUFBSSxH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cmF0ZWd5LFxyXG4gIENoYW5nZURldGVjdG9yUmVmLFxyXG4gIENvbXBvbmVudCxcclxuICBFdmVudEVtaXR0ZXIsXHJcbiAgSW5qZWN0LFxyXG4gIElucHV0LFxyXG4gIExPQ0FMRV9JRCxcclxuICBPbkNoYW5nZXMsXHJcbiAgT25Jbml0LFxyXG4gIE91dHB1dCxcclxuICBTaW1wbGVDaGFuZ2VzLFxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBGb3JtU3R5bGUsIGdldExvY2FsZURheU5hbWVzLCBUcmFuc2xhdGlvbldpZHRoLCBXZWVrRGF5IH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcclxuaW1wb3J0IHsgQ29udHJvbFZhbHVlQWNjZXNzb3IsIE5HX1ZBTFVFX0FDQ0VTU09SIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xyXG5pbXBvcnQgeyBpc1ZhbGlkRGF0ZSwgbm9vcCwgc3RhcnRPZkRheSB9IGZyb20gJy4uL3V0aWwvaGVscGVycyc7XHJcbmltcG9ydCB7IFZpZXdNb2RlIH0gZnJvbSAnLi92aWV3LW1vZGUnO1xyXG5pbXBvcnQgeyBab29tRGlyZWN0aW9uIH0gZnJvbSAnLi4vdXRpbC96b29tLmFuaW1hdGlvbic7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ3NrbS1kYXRlcGlja2VyJyxcclxuICB0ZW1wbGF0ZTogYDxkaXYgY2xhc3M9XCJza20tZGF0ZXBpY2tlclwiIFtuZ1N3aXRjaF09XCJ2aWV3XCI+XHJcbiAgPHNrbS12aWV3XHJcbiAgICAqbmdTd2l0Y2hDYXNlPVwiVmlld01vZGUuRGF5c1wiXHJcbiAgICBza21EYXlzU3RyYXRlZ3lcclxuICAgIGNsYXNzPVwic2ttLWRhdGVwaWNrZXItdmlldyBza20tZGF0ZXBpY2tlci1kYXlzLXZpZXdcIlxyXG4gICAgW3pvb21EaXJlY3Rpb25dPVwiem9vbURpcmVjdGlvblwiXHJcbiAgICBbaW5pdGlhbFRpbWVzdGFtcF09XCJpbml0aWFsVGltZXN0YW1wXCJcclxuXHJcbiAgICBbY3VycmVudFRpbWVzdGFtcF09XCJjdXJyZW50VGltZXN0YW1wXCJcclxuICAgIFtzZWxlY3RlZFRpbWVzdGFtcF09XCJzZWxlY3RlZFRpbWVzdGFtcFwiXHJcbiAgICBbbWluVGltZXN0YW1wXT1cIm1pblRpbWVzdGFtcFwiXHJcbiAgICBbbWF4VGltZXN0YW1wXT1cIm1heFRpbWVzdGFtcFwiXHJcblxyXG4gICAgW2Rlc2VsZWN0RW5hYmxlZF09XCJkZXNlbGVjdEVuYWJsZWRcIlxyXG5cclxuICAgIFtoZWFkaW5nRm9ybWF0XT1cImhlYWRpbmdGb3JtYXRcIlxyXG4gICAgW3dlZWtTdGFydF09XCJ3ZWVrU3RhcnRcIlxyXG4gICAgW3dlZWtEYXlMYWJlbHNdPVwid2Vla0RheUxhYmVsc1wiXHJcbiAgICBbaXRlbUZvcm1hdF09XCJkYXlGb3JtYXRcIlxyXG4gICAgW2l0ZW1MYWJlbHNdPVwiZGF5TGFiZWxzXCJcclxuXHJcbiAgICAoaGVhZGVyQ2xpY2spPVwic3dpdGNoVmlldygkZXZlbnQsIFZpZXdNb2RlLk1vbnRocywgJ291dCcpXCJcclxuICAgIChpdGVtQ2hhbmdlKT1cInNlbGVjdERheSgkZXZlbnQpXCJcclxuICA+PC9za20tdmlldz5cclxuICA8c2ttLXZpZXdcclxuICAgICpuZ1N3aXRjaENhc2U9XCJWaWV3TW9kZS5Nb250aHNcIlxyXG4gICAgc2ttTW9udGhzU3RyYXRlZ3lcclxuICAgIGNsYXNzPVwic2ttLWRhdGVwaWNrZXItdmlldyBza20tZGF0ZXBpY2tlci1tb250aHMtdmlld1wiXHJcbiAgICBbem9vbURpcmVjdGlvbl09XCJ6b29tRGlyZWN0aW9uXCJcclxuICAgIFtpbml0aWFsVGltZXN0YW1wXT1cImluaXRpYWxUaW1lc3RhbXBcIlxyXG5cclxuICAgIFtjdXJyZW50VGltZXN0YW1wXT1cImN1cnJlbnRUaW1lc3RhbXBcIlxyXG4gICAgW3NlbGVjdGVkVGltZXN0YW1wXT1cInNlbGVjdGVkVGltZXN0YW1wXCJcclxuICAgIFttaW5UaW1lc3RhbXBdPVwibWluVGltZXN0YW1wXCJcclxuICAgIFttYXhUaW1lc3RhbXBdPVwibWF4VGltZXN0YW1wXCJcclxuXHJcbiAgICBbaGVhZGluZ0Zvcm1hdF09XCJ5ZWFyRm9ybWF0XCJcclxuICAgIFtpdGVtRm9ybWF0XT1cIm1vbnRoRm9ybWF0XCJcclxuICAgIFtpdGVtTGFiZWxzXT1cIm1vbnRoTGFiZWxzXCJcclxuXHJcbiAgICAoaGVhZGVyQ2xpY2spPVwic3dpdGNoVmlldygkZXZlbnQsIFZpZXdNb2RlLlllYXJzLCAnb3V0JylcIlxyXG4gICAgKGl0ZW1DaGFuZ2UpPVwic3dpdGNoVmlldygkZXZlbnQsIFZpZXdNb2RlLkRheXMsICdpbicpXCJcclxuICA+PC9za20tdmlldz5cclxuICA8c2ttLXZpZXdcclxuICAgICpuZ1N3aXRjaENhc2U9XCJWaWV3TW9kZS5ZZWFyc1wiXHJcbiAgICBza21ZZWFyc1N0cmF0ZWd5XHJcbiAgICBjbGFzcz1cInNrbS1kYXRlcGlja2VyLXZpZXcgc2ttLWRhdGVwaWNrZXIteWVhcnMtdmlld1wiXHJcbiAgICBbem9vbURpcmVjdGlvbl09XCJ6b29tRGlyZWN0aW9uXCJcclxuICAgIFtpbml0aWFsVGltZXN0YW1wXT1cImluaXRpYWxUaW1lc3RhbXBcIlxyXG5cclxuICAgIFtjdXJyZW50VGltZXN0YW1wXT1cImN1cnJlbnRUaW1lc3RhbXBcIlxyXG4gICAgW3NlbGVjdGVkVGltZXN0YW1wXT1cInNlbGVjdGVkVGltZXN0YW1wXCJcclxuICAgIFttaW5UaW1lc3RhbXBdPVwibWluVGltZXN0YW1wXCJcclxuICAgIFttYXhUaW1lc3RhbXBdPVwibWF4VGltZXN0YW1wXCJcclxuXHJcbiAgICBbaGVhZGluZ0Zvcm1hdF09XCJ5ZWFyRm9ybWF0XCJcclxuICAgIFtpdGVtRm9ybWF0XT1cInllYXJGb3JtYXRcIlxyXG5cclxuICAgIChpdGVtQ2hhbmdlKT1cInN3aXRjaFZpZXcoJGV2ZW50LCBWaWV3TW9kZS5Nb250aHMsICdpbicpXCJcclxuICA+PC9za20tdmlldz5cclxuPC9kaXY+XHJcbmAsXHJcbiAgc3R5bGVzOiBbYC5za20tZGF0ZXBpY2tlcntwb3NpdGlvbjpyZWxhdGl2ZTtvdmVyZmxvdzpoaWRkZW59LnNrbS1kYXRlcGlja2VyLXZpZXd7ZGlzcGxheTpibG9jaztwb3NpdGlvbjphYnNvbHV0ZTtoZWlnaHQ6MTAwJTt3aWR0aDoxMDAlfWAsIGBidXR0b257ZGlzcGxheTpibG9jaztjb2xvcjppbmhlcml0fWJ1dHRvbjpub3QoW2Rpc2FibGVkXSl7Y3Vyc29yOnBvaW50ZXJ9YnV0dG9uW2Rpc2FibGVkXXtwb2ludGVyLWV2ZW50czpub25lfS5za20tZGF0ZXBpY2tlci1wYW5le2ZsZXgtc2hyaW5rOjA7d2lkdGg6MTAwJTtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO292ZXJmbG93OmhpZGRlbn0uc2ttLWRhdGVwaWNrZXItd2Vla3tkaXNwbGF5OmZsZXh9LnNrbS1kYXRlcGlja2VyLXdlZWtkYXl7d2lkdGg6MTQuMjg1NzElfS5za20tZGF0ZXBpY2tlci1jb250ZW50e2ZsZXg6MSAwIDA7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbn0uc2ttLWRhdGVwaWNrZXItZ3JpZHtmbGV4OjEgMCAwO2Rpc3BsYXk6ZmxleDtmbGV4LXdyYXA6d3JhcDthbGlnbi1jb250ZW50OmZsZXgtc3RhcnQ7cG9pbnRlci1ldmVudHM6bm9uZX0uc2ttLWRhdGVwaWNrZXItaW5kZW50e2hlaWdodDoxNi42NjY2NyV9LnNrbS1kYXRlcGlja2VyLWNlbGx7ZGlzcGxheTpmbGV4fTpob3N0LWNvbnRleHQoLnNrbS1kYXRlcGlja2VyLWRheXMtdmlldykgLnNrbS1kYXRlcGlja2VyLWNlbGx7d2lkdGg6MTQuMjg1NzElO2hlaWdodDoxNi42NjY2NyV9Omhvc3QtY29udGV4dCguc2ttLWRhdGVwaWNrZXItbW9udGhzLXZpZXcpIC5za20tZGF0ZXBpY2tlci1jZWxse3dpZHRoOjMzLjMzMzMzJTtoZWlnaHQ6MjUlfTpob3N0LWNvbnRleHQoLnNrbS1kYXRlcGlja2VyLXllYXJzLXZpZXcpIC5za20tZGF0ZXBpY2tlci1jZWxse3dpZHRoOjIwJTtoZWlnaHQ6MjUlfS5za20tZGF0ZXBpY2tlci1pdGVte2ZsZXg6MTtwb2ludGVyLWV2ZW50czphdXRvfWBdLFxyXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxyXG4gIHByb3ZpZGVyczogW1xyXG4gICAge3Byb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLCB1c2VFeGlzdGluZzogRGF0ZXBpY2tlckNvbXBvbmVudCwgbXVsdGk6IHRydWV9LFxyXG4gIF0sXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBEYXRlcGlja2VyQ29tcG9uZW50IGltcGxlbWVudHMgQ29udHJvbFZhbHVlQWNjZXNzb3IsIE9uQ2hhbmdlcywgT25Jbml0IHtcclxuICBASW5wdXQoKSBzZXQgZGF0ZShkaXJ0eURhdGU6IERhdGUgfCBudW1iZXIpIHtcclxuICAgIGlmIChkaXJ0eURhdGUgPT0gbnVsbCkge1xyXG4gICAgICB0aGlzLnNlbGVjdGVkVGltZXN0YW1wID0gdW5kZWZpbmVkO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBkYXRlID0gc3RhcnRPZkRheShkaXJ0eURhdGUpO1xyXG4gICAgaWYgKGRhdGUuZ2V0VGltZSgpICE9PSB0aGlzLnNlbGVjdGVkVGltZXN0YW1wKSB7XHJcbiAgICAgIHRoaXMuc2VsZWN0ZWRUaW1lc3RhbXAgPSBpc1ZhbGlkRGF0ZShkYXRlKSA/IGRhdGUuZ2V0VGltZSgpIDogdW5kZWZpbmVkO1xyXG4gICAgICBpZiAodHlwZW9mIHRoaXMuc2VsZWN0ZWRUaW1lc3RhbXAgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgdGhpcy5pbml0aWFsVGltZXN0YW1wID0gdGhpcy5zZWxlY3RlZFRpbWVzdGFtcDtcclxuICAgICAgICB0aGlzLnZpZXcgPSBWaWV3TW9kZS5EYXlzO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBAT3V0cHV0KCkgZGF0ZUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8RGF0ZT4oKTtcclxuXHJcbiAgQElucHV0KCkgc2V0IG1pbihkaXJ0eURhdGU6IERhdGUgfCBudW1iZXIpIHtcclxuICAgIGNvbnN0IGRhdGUgPSBzdGFydE9mRGF5KGRpcnR5RGF0ZSk7XHJcbiAgICB0aGlzLm1pblRpbWVzdGFtcCA9IGlzVmFsaWREYXRlKGRhdGUpID8gZGF0ZS52YWx1ZU9mKCkgOiB1bmRlZmluZWQ7XHJcbiAgfVxyXG5cclxuICBASW5wdXQoKSBzZXQgbWF4KGRpcnR5RGF0ZTogRGF0ZSB8IG51bWJlcikge1xyXG4gICAgY29uc3QgZGF0ZSA9IHN0YXJ0T2ZEYXkoZGlydHlEYXRlKTtcclxuICAgIHRoaXMubWF4VGltZXN0YW1wID0gaXNWYWxpZERhdGUoZGF0ZSkgPyBkYXRlLnZhbHVlT2YoKSA6IHVuZGVmaW5lZDtcclxuICB9XHJcblxyXG4gIEBJbnB1dCgpIGRlc2VsZWN0RW5hYmxlZDogYm9vbGVhbjtcclxuXHJcbiAgQElucHV0KCkgZGF5Rm9ybWF0ID0gJ2QnO1xyXG4gIEBJbnB1dCgpIG1vbnRoRm9ybWF0ID0gJ01NTSc7XHJcbiAgQElucHV0KCkgeWVhckZvcm1hdCA9ICd5JztcclxuICBASW5wdXQoKSBoZWFkaW5nRm9ybWF0ID0gJ01NTU0geSc7XHJcbiAgQElucHV0KCkgd2Vla1N0YXJ0ID0gV2Vla0RheS5Nb25kYXk7XHJcblxyXG4gIEBJbnB1dCgpIGRheUxhYmVsczogc3RyaW5nW107XHJcbiAgQElucHV0KCkgd2Vla0RheUxhYmVsczogc3RyaW5nW107XHJcbiAgQElucHV0KCkgbW9udGhMYWJlbHM6IHN0cmluZ1tdO1xyXG5cclxuICBASW5wdXQoKSB2aWV3ID0gVmlld01vZGUuRGF5cztcclxuXHJcbiAgaW5pdGlhbFRpbWVzdGFtcDogbnVtYmVyO1xyXG4gIGN1cnJlbnRUaW1lc3RhbXA6IG51bWJlcjtcclxuICBzZWxlY3RlZFRpbWVzdGFtcDogbnVtYmVyO1xyXG4gIG1pblRpbWVzdGFtcDogbnVtYmVyO1xyXG4gIG1heFRpbWVzdGFtcDogbnVtYmVyO1xyXG5cclxuICB6b29tRGlyZWN0aW9uOiBab29tRGlyZWN0aW9uO1xyXG4gIHJlYWRvbmx5IFZpZXdNb2RlID0gVmlld01vZGU7XHJcblxyXG4gIHByaXZhdGUgb25DaGFuZ2U6IChkYXRlOiBEYXRlKSA9PiB2b2lkID0gbm9vcDtcclxuICBwcml2YXRlIG9uVG91Y2hlZDogKCkgPT4gdm9pZCA9IG5vb3A7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgY2Q6IENoYW5nZURldGVjdG9yUmVmLCBASW5qZWN0KExPQ0FMRV9JRCkgcHJpdmF0ZSBsb2NhbGU6IHN0cmluZykge1xyXG4gIH1cclxuXHJcbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xyXG4gICAgaWYgKCd3ZWVrRGF5TGFiZWxzJyBpbiBjaGFuZ2VzKSB7XHJcbiAgICAgIHRoaXMud2Vla0RheUxhYmVscyA9IHRoaXMud2Vla0RheUxhYmVscyB8fCBnZXRMb2NhbGVEYXlOYW1lcyh0aGlzLmxvY2FsZSwgRm9ybVN0eWxlLlN0YW5kYWxvbmUsIFRyYW5zbGF0aW9uV2lkdGguQWJicmV2aWF0ZWQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLmN1cnJlbnRUaW1lc3RhbXAgPSBzdGFydE9mRGF5KG5ldyBEYXRlKCkpLmdldFRpbWUoKTtcclxuICAgIHRoaXMuaW5pdGlhbFRpbWVzdGFtcCA9IHRoaXMuc2VsZWN0ZWRUaW1lc3RhbXAgfHwgdGhpcy5jdXJyZW50VGltZXN0YW1wO1xyXG4gICAgdGhpcy53ZWVrRGF5TGFiZWxzID0gdGhpcy53ZWVrRGF5TGFiZWxzIHx8IGdldExvY2FsZURheU5hbWVzKHRoaXMubG9jYWxlLCBGb3JtU3R5bGUuU3RhbmRhbG9uZSwgVHJhbnNsYXRpb25XaWR0aC5BYmJyZXZpYXRlZCk7XHJcbiAgfVxyXG5cclxuICBzZWxlY3REYXkodGltZXN0YW1wOiBudW1iZXIgfCB1bmRlZmluZWQpOiB2b2lkIHtcclxuICAgIGNvbnNvbGUubG9nKHRpbWVzdGFtcCk7XHJcbiAgICB0aGlzLnNlbGVjdGVkVGltZXN0YW1wID0gdGltZXN0YW1wO1xyXG4gICAgY29uc3QgZGF0ZSA9ICh0eXBlb2YgdGltZXN0YW1wICE9PSAndW5kZWZpbmVkJykgPyBuZXcgRGF0ZSh0aW1lc3RhbXApIDogdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5vbkNoYW5nZShkYXRlKTtcclxuICAgIHRoaXMuZGF0ZUNoYW5nZS5lbWl0KGRhdGUpO1xyXG4gIH1cclxuXHJcbiAgc3dpdGNoVmlldyh0aW1lc3RhbXA6IG51bWJlciwgdmlldzogVmlld01vZGUsIGRpcmVjdGlvbjogWm9vbURpcmVjdGlvbikge1xyXG4gICAgdGhpcy56b29tRGlyZWN0aW9uID0gZGlyZWN0aW9uO1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIHRoaXMuaW5pdGlhbFRpbWVzdGFtcCA9IHRpbWVzdGFtcDtcclxuICAgICAgdGhpcy52aWV3ID0gdmlldztcclxuICAgICAgdGhpcy5jZC5tYXJrRm9yQ2hlY2soKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gQ29udHJvbFZhbHVlQWNjZXNzb3IgaW1wbGVtZW50YXRpb25cclxuXHJcbiAgd3JpdGVWYWx1ZShvYmo6IGFueSk6IHZvaWQge1xyXG4gICAgdGhpcy5kYXRlID0gb2JqO1xyXG4gICAgdGhpcy5jZC5tYXJrRm9yQ2hlY2soKTtcclxuICB9XHJcblxyXG4gIHJlZ2lzdGVyT25DaGFuZ2UoZm46IGFueSk6IHZvaWQge1xyXG4gICAgdGhpcy5vbkNoYW5nZSA9IGZuO1xyXG4gIH1cclxuXHJcbiAgcmVnaXN0ZXJPblRvdWNoZWQoZm46IGFueSk6IHZvaWQge1xyXG4gICAgdGhpcy5vblRvdWNoZWQgPSBmbjtcclxuICAgIC8vIFRPRE8gaW1wbGVtZW50XHJcbiAgfVxyXG5cclxuICBzZXREaXNhYmxlZFN0YXRlKGlzRGlzYWJsZWQ6IGJvb2xlYW4pOiB2b2lkIHtcclxuICAgIC8vIFRPRE8gaW1wbGVtZW50XHJcbiAgICB0aGlzLmNkLm1hcmtGb3JDaGVjaygpO1xyXG4gIH1cclxuXHJcbn1cclxuIl19